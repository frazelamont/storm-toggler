(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
'use strict';

var _component = require('./libs/component');

var _component2 = _interopRequireDefault(_component);

function _interopRequireDefault(obj) {
	return obj && obj.__esModule ? obj : { default: obj };
}

var onDOMContentLoadedTasks = [function () {
	_component2.default.init('.js-toggle');
	_component2.default.init('.js-toggle__local', {
		local: true,
		delay: 0,
		callback: function callback() {
			var _this = this;

			if (this.open) {
				global.Togglers.forEach(function (toggler) {
					if (toggler !== _this && !!toggler.open && toggler.DOMElement !== _this.targetElement) {
						toggler.toggle();
					}
				});
			}
		}
	});
}];

global.Togglers = {};

if ('addEventListener' in window) window.addEventListener('DOMContentLoaded', function () {
	onDOMContentLoadedTasks.forEach(function (fn) {
		return fn();
	});
});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./libs/component":2}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _defaults = require('./lib/defaults');

var _defaults2 = _interopRequireDefault(_defaults);

var _componentPrototype = require('./lib/component-prototype');

var _componentPrototype2 = _interopRequireDefault(_componentPrototype);

function _interopRequireDefault(obj) {
	return obj && obj.__esModule ? obj : { default: obj };
}

var init = function init(sel, opts) {
	var els = [].slice.call(document.querySelectorAll(sel));

	if (!els.length) throw new Error('Toggler cannot be initialised, no augmentable elements found');

	return els.map(function (el) {
		return Object.assign(Object.create(_componentPrototype2.default), {
			btn: el,
			targetId: (el.getAttribute('href') || el.getAttribute('data-target')).substr(1),
			settings: Object.assign({}, _defaults2.default, opts)
		}).init();
	});
};

exports.default = { init: init };

},{"./lib/component-prototype":3,"./lib/defaults":4}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
var TRIGGER_EVENTS = [window.PointerEvent ? 'pointerdown' : 'ontouchstart' in window ? 'touchstart' : 'click', 'keydown'],
    TRIGGER_KEYCODES = [13, 32];

exports.default = {
	init: function init() {
		var _this = this;

		this.targetElement = document.getElementById(this.targetId);
		this.classTarget = !this.settings.local ? document.documentElement : this.targetElement.parentNode;
		this.siblingBtns = [].slice.call(document.querySelectorAll('[href="#' + this.targetId + '"], [data-target="#' + this.targetId + '"]'));
		if (this.settings.focus) this.focusableChildren = this.getFocusableChildren();
		if (this.settings.trapTab) this.boundKeyListener = this.keyListener.bind(this);

		this.statusClass = !this.settings.local ? 'on--' + this.targetId : 'active';
		this.animatingClass = !this.settings.local ? 'animating--' + this.targetId : 'animating';

		this.siblingBtns.forEach(function (btn) {
			btn.setAttribute('role', 'button');
			btn.setAttribute('aria-controls', _this.targetId);
			btn.setAttribute('aria-expanded', 'false');
		});

		TRIGGER_EVENTS.forEach(function (ev) {
			_this.btn.addEventListener(ev, function (e) {
				if (!!e.keyCode && !~TRIGGER_KEYCODES.indexOf(e.keyCode)) return;
				_this.toggle(e);
			});
		});
		this.settings.startOpen && this.toggle();

		return this;
	},
	getFocusableChildren: function getFocusableChildren() {
		var focusableElements = ['a[href]', 'area[href]', 'input:not([disabled])', 'select:not([disabled])', 'textarea:not([disabled])', 'button:not([disabled])', 'iframe', 'object', 'embed', '[contenteditable]', '[tabindex]:not([tabindex="-1"])'];

		return [].slice.call(this.targetElement.querySelectorAll(focusableElements.join(',')));
	},

	toggleAttributes: function toggleAttributes() {
		this.isOpen = !this.isOpen;
		this.siblingBtns.forEach(function (sibling) {
			sibling.setAttribute('aria-expanded', sibling.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
		});
	},
	toggleDocumentState: function toggleDocumentState() {
		this.classTarget.classList.remove(this.animatingClass);
		this.classTarget.classList.toggle(this.statusClass);
	},
	manageFocus: function manageFocus() {
		var _this2 = this;

		if (!this.isOpen) {
			this.lastFocused = document.activeElement;
			this.focusableChildren.length && window.setTimeout(function () {
				return _this2.focusableChildren[0].focus();
			}, this.settings.delay);
			this.settings.trapTab && document.addEventListener('keydown', this.boundKeyListener);
		} else {
			this.settings.trapTab && document.removeEventListener('keydown', this.boundKeyListener);
			this.focusableChildren.length && window.setTimeout(function () {
				_this2.lastFocused.focus();
				_this2.lastFocused = false;
			}, this.settings.delay);
		}
	},
	trapTab: function trapTab(e) {
		var focusedIndex = this.focusableChildren.indexOf(document.activeElement);
		if (e.shiftKey && focusedIndex === 0) {
			e.preventDefault();
			this.focusableChildren[this.focusableChildren.length - 1].focus();
		} else {
			if (!e.shiftKey && focusedIndex === this.focusableChildren.length - 1) {
				e.preventDefault();
				this.focusableChildren[0].focus();
			}
		}
	},
	keyListener: function keyListener(e) {
		if (this.isOpen && e.keyCode === 27) {
			e.preventDefault();
			this.toggle();
		}
		if (this.isOpen && e.keyCode === 9) this.trapTab(e);
	},

	toggle: function toggle(e) {
		var _this3 = this;

		var delay = this.classTarget.classList.contains(this.statusClass) ? this.settings.delay : 0;

		!!this.settings.prehook && typeof this.settings.prehook === 'function' && this.settings.prehook.call(this);

		if (e) {
			e.preventDefault();
			e.stopPropagation();
		}

		this.classTarget.classList.add(this.animatingClass);

		window.setTimeout(function () {
			!!_this3.settings.focus && _this3.focusableChildren && _this3.manageFocus();
			_this3.toggleAttributes();
			_this3.toggleDocumentState();
			!!_this3.settings.callback && typeof _this3.settings.callback === 'function' && _this3.settings.callback.call(_this3);
		}, delay);
	}
};

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = {
	delay: 0,
	startOpen: false,
	local: false,
	prehook: false,
	callback: false,
	focus: true,
	trapTab: false
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlL3NyYy9hcHAuanMiLCJleGFtcGxlL3NyYy9saWJzL2NvbXBvbmVudC9pbmRleC5qcyIsImV4YW1wbGUvc3JjL2xpYnMvY29tcG9uZW50L2xpYi9jb21wb25lbnQtcHJvdG90eXBlLmpzIiwiZXhhbXBsZS9zcmMvbGlicy9jb21wb25lbnQvbGliL2RlZmF1bHRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FDQUE7Ozs7Ozs7O0FBRUEsSUFBTSwyQkFBMkIsWUFBTSxBQUN0QztxQkFBQSxBQUFRLEtBQVIsQUFBYSxBQUNiO3FCQUFBLEFBQVEsS0FBUixBQUFhO1NBQXFCLEFBQzFCLEFBQ1A7U0FGaUMsQUFFMUIsQUFDUDtZQUFVLG9CQUFXO2VBQ3BCOztPQUFHLEtBQUgsQUFBUSxNQUFLLEFBQ1o7V0FBQSxBQUFPLFNBQVAsQUFBZ0IsUUFBUSxtQkFBVyxBQUNsQztTQUFHLHFCQUFvQixDQUFDLENBQUMsUUFBdEIsQUFBOEIsUUFBUSxRQUFBLEFBQVEsZUFBZSxNQUFoRSxBQUFxRSxlQUFjLEFBQ2xGO2NBQUEsQUFBUSxBQUNSO0FBQ0Q7QUFKRCxBQUtBO0FBQ0Q7QUFYRixBQUFrQyxBQWFsQztBQWJrQyxBQUNqQztBQUhGLEFBQWdDLENBQUE7O0FBaUJoQyxPQUFBLEFBQU8sV0FBUCxBQUFrQjs7QUFFbEIsSUFBRyxzQkFBSCxBQUF5QixlQUFRLEFBQU8saUJBQVAsQUFBd0Isb0JBQW9CLFlBQU0sQUFBRTt5QkFBQSxBQUF3QixRQUFRLFVBQUEsQUFBQyxJQUFEO1NBQUEsQUFBUTtBQUF4QyxBQUFnRDtBQUFwRyxDQUFBOzs7Ozs7Ozs7OztBQ3JCakM7Ozs7QUFDQTs7Ozs7Ozs7QUFFQSxJQUFNLE9BQU8sU0FBUCxBQUFPLEtBQUEsQUFBQyxLQUFELEFBQU0sTUFBUyxBQUMzQjtLQUFJLE1BQU0sR0FBQSxBQUFHLE1BQUgsQUFBUyxLQUFLLFNBQUEsQUFBUyxpQkFBakMsQUFBVSxBQUFjLEFBQTBCLEFBRWxEOztLQUFHLENBQUMsSUFBSixBQUFRLFFBQVEsTUFBTSxJQUFBLEFBQUksTUFBVixBQUFNLEFBQVUsQUFFaEM7O1lBQU8sQUFBSSxJQUFJLFVBQUEsQUFBQyxJQUFPLEFBQ3RCO2dCQUFPLEFBQU8sT0FBTyxPQUFBLEFBQU8sNEJBQXJCO1FBQWlELEFBQ2xELEFBQ0w7YUFBVSxDQUFDLEdBQUEsQUFBRyxhQUFILEFBQWdCLFdBQVUsR0FBQSxBQUFHLGFBQTlCLEFBQTJCLEFBQWdCLGdCQUEzQyxBQUEyRCxPQUZkLEFBRTdDLEFBQWtFLEFBQzVFO2FBQVUsT0FBQSxBQUFPLE9BQVAsQUFBYyx3QkFIbEIsQUFBaUQsQUFHN0MsQUFBNEI7QUFIaUIsQUFDdkQsR0FETSxFQUFQLEFBQU8sQUFJSixBQUNIO0FBTkQsQUFBTyxBQU9QLEVBUE87QUFMUjs7a0JBY2UsRUFBRSxNLEFBQUY7Ozs7Ozs7O0FDakJmLElBQU0saUJBQWlCLENBQUMsT0FBQSxBQUFPLGVBQVAsQUFBc0IsZ0JBQWdCLGtCQUFBLEFBQWtCLFNBQWxCLEFBQTJCLGVBQWxFLEFBQWlGLFNBQXhHLEFBQXVCLEFBQTBGO0lBQzNHLG1CQUFtQixDQUFBLEFBQUMsSUFEMUIsQUFDeUIsQUFBSzs7O0FBRWYsdUJBQ1A7Y0FDTjs7T0FBQSxBQUFLLGdCQUFnQixTQUFBLEFBQVMsZUFBZSxLQUE3QyxBQUFxQixBQUE2QixBQUNsRDtPQUFBLEFBQUssY0FBZSxDQUFDLEtBQUEsQUFBSyxTQUFQLEFBQWdCLFFBQVMsU0FBekIsQUFBa0Msa0JBQWtCLEtBQUEsQUFBSyxjQUE1RSxBQUEwRixBQUMxRjtPQUFBLEFBQUssY0FBYyxHQUFBLEFBQUcsTUFBSCxBQUFTLEtBQUssU0FBQSxBQUFTLGlCQUFpQixhQUFhLEtBQWIsQUFBa0IsV0FBbEIsQUFBNkIsd0JBQXdCLEtBQXJELEFBQTBELFdBQXJILEFBQW1CLEFBQWMsQUFBK0YsQUFDaEk7TUFBRyxLQUFBLEFBQUssU0FBUixBQUFpQixPQUFPLEtBQUEsQUFBSyxvQkFBb0IsS0FBekIsQUFBeUIsQUFBSyxBQUN0RDtNQUFHLEtBQUEsQUFBSyxTQUFSLEFBQWlCLFNBQVMsS0FBQSxBQUFLLG1CQUFtQixLQUFBLEFBQUssWUFBTCxBQUFpQixLQUF6QyxBQUF3QixBQUFzQixBQUV4RTs7T0FBQSxBQUFLLGNBQWMsQ0FBQyxLQUFBLEFBQUssU0FBTixBQUFlLGlCQUFlLEtBQTlCLEFBQW1DLFdBQXRELEFBQW1FLEFBQ25FO09BQUEsQUFBSyxpQkFBaUIsQ0FBQyxLQUFBLEFBQUssU0FBTixBQUFlLHdCQUFzQixLQUFyQyxBQUEwQyxXQUFoRSxBQUE2RSxBQUU3RTs7T0FBQSxBQUFLLFlBQUwsQUFBaUIsUUFBUSxlQUFPLEFBQy9CO09BQUEsQUFBSSxhQUFKLEFBQWlCLFFBQWpCLEFBQXdCLEFBQ3hCO09BQUEsQUFBSSxhQUFKLEFBQWlCLGlCQUFpQixNQUFsQyxBQUF1QyxBQUN2QztPQUFBLEFBQUksYUFBSixBQUFpQixpQkFBakIsQUFBa0MsQUFDbEM7QUFKRCxBQU1NOztpQkFBQSxBQUFlLFFBQVEsY0FBTSxBQUMvQjtTQUFBLEFBQUssSUFBTCxBQUFTLGlCQUFULEFBQTBCLElBQUksYUFBSyxBQUN6QjtRQUFHLENBQUMsQ0FBQyxFQUFGLEFBQUksV0FBVyxDQUFDLENBQUMsaUJBQUEsQUFBaUIsUUFBUSxFQUE3QyxBQUFvQixBQUEyQixVQUFVLEFBQ3pEO1VBQUEsQUFBSyxPQUFMLEFBQVksQUFDZjtBQUhQLEFBSUc7QUFMRCxBQU1OO09BQUEsQUFBSyxTQUFMLEFBQWMsYUFBYSxLQUEzQixBQUEyQixBQUFLLEFBRWhDOztTQUFBLEFBQU8sQUFDUDtBQTFCYSxBQTJCZDtBQTNCYyx1REEyQlMsQUFDdEI7TUFBTSxvQkFBb0IsQ0FBQSxBQUFDLFdBQUQsQUFBWSxjQUFaLEFBQTBCLHlCQUExQixBQUFtRCwwQkFBbkQsQUFBNkUsNEJBQTdFLEFBQXlHLDBCQUF6RyxBQUFtSSxVQUFuSSxBQUE2SSxVQUE3SSxBQUF1SixTQUF2SixBQUFnSyxxQkFBMUwsQUFBMEIsQUFBcUwsQUFFL007O1NBQU8sR0FBQSxBQUFHLE1BQUgsQUFBUyxLQUFLLEtBQUEsQUFBSyxjQUFMLEFBQW1CLGlCQUFpQixrQkFBQSxBQUFrQixLQUEzRSxBQUFPLEFBQWMsQUFBb0MsQUFBdUIsQUFDaEY7QUEvQmEsQUFnQ2Q7O21CQUFrQiw0QkFBVSxBQUMzQjtPQUFBLEFBQUssU0FBUyxDQUFDLEtBQWYsQUFBb0IsQUFDcEI7T0FBQSxBQUFLLFlBQUwsQUFBaUIsUUFBUSxtQkFBVyxBQUNuQztXQUFBLEFBQVEsYUFBUixBQUFxQixpQkFBaUIsUUFBQSxBQUFRLGFBQVIsQUFBcUIscUJBQXJCLEFBQTBDLFNBQTFDLEFBQW1ELFVBQXpGLEFBQW1HLEFBQ25HO0FBRkQsQUFHQTtBQXJDYSxBQXNDZDtzQkFBcUIsK0JBQVUsQUFDOUI7T0FBQSxBQUFLLFlBQUwsQUFBaUIsVUFBakIsQUFBMkIsT0FBTyxLQUFsQyxBQUF1QyxBQUN2QztPQUFBLEFBQUssWUFBTCxBQUFpQixVQUFqQixBQUEyQixPQUFPLEtBQWxDLEFBQXVDLEFBQ3ZDO0FBekNhLEFBMENkO2NBQWEsdUJBQVU7ZUFDdEI7O01BQUcsQ0FBQyxLQUFKLEFBQVMsUUFBTyxBQUNmO1FBQUEsQUFBSyxjQUFjLFNBQW5CLEFBQTRCLEFBQzVCO1FBQUEsQUFBSyxrQkFBTCxBQUF1QixpQkFBVSxBQUFPLFdBQVcsWUFBQTtXQUFNLE9BQUEsQUFBSyxrQkFBTCxBQUF1QixHQUE3QixBQUFNLEFBQTBCO0FBQWxELElBQUEsRUFBMkQsS0FBQSxBQUFLLFNBQWpHLEFBQWlDLEFBQXlFLEFBQzFHO1FBQUEsQUFBSyxTQUFMLEFBQWMsV0FBVyxTQUFBLEFBQVMsaUJBQVQsQUFBMEIsV0FBVyxLQUE5RCxBQUF5QixBQUEwQyxBQUNuRTtBQUpELFNBS0ssQUFDSjtRQUFBLEFBQUssU0FBTCxBQUFjLFdBQVcsU0FBQSxBQUFTLG9CQUFULEFBQTZCLFdBQVcsS0FBakUsQUFBeUIsQUFBNkMsQUFDdEU7UUFBQSxBQUFLLGtCQUFMLEFBQXVCLGlCQUFVLEFBQU8sV0FBVyxZQUFNLEFBQ3hEO1dBQUEsQUFBSyxZQUFMLEFBQWlCLEFBQ2pCO1dBQUEsQUFBSyxjQUFMLEFBQW1CLEFBQ25CO0FBSGdDLElBQUEsRUFHOUIsS0FBQSxBQUFLLFNBSFIsQUFBaUMsQUFHaEIsQUFDakI7QUFDRDtBQXZEYSxBQXdEZDtVQUFTLGlCQUFBLEFBQVMsR0FBRSxBQUNuQjtNQUFJLGVBQWUsS0FBQSxBQUFLLGtCQUFMLEFBQXVCLFFBQVEsU0FBbEQsQUFBbUIsQUFBd0MsQUFDM0Q7TUFBRyxFQUFBLEFBQUUsWUFBWSxpQkFBakIsQUFBa0MsR0FBRyxBQUNwQztLQUFBLEFBQUUsQUFDRjtRQUFBLEFBQUssa0JBQWtCLEtBQUEsQUFBSyxrQkFBTCxBQUF1QixTQUE5QyxBQUF1RCxHQUF2RCxBQUEwRCxBQUMxRDtBQUhELFNBR08sQUFDTjtPQUFHLENBQUMsRUFBRCxBQUFHLFlBQVksaUJBQWlCLEtBQUEsQUFBSyxrQkFBTCxBQUF1QixTQUExRCxBQUFtRSxHQUFHLEFBQ3JFO01BQUEsQUFBRSxBQUNGO1NBQUEsQUFBSyxrQkFBTCxBQUF1QixHQUF2QixBQUEwQixBQUMxQjtBQUNEO0FBQ0Q7QUFuRWEsQUFvRWQ7QUFwRWMsbUNBQUEsQUFvRUYsR0FBRSxBQUNiO01BQUksS0FBQSxBQUFLLFVBQVUsRUFBQSxBQUFFLFlBQXJCLEFBQWlDLElBQUksQUFDcEM7S0FBQSxBQUFFLEFBQ0Y7UUFBQSxBQUFLLEFBQ0w7QUFDRDtNQUFJLEtBQUEsQUFBSyxVQUFVLEVBQUEsQUFBRSxZQUFyQixBQUFpQyxHQUFHLEtBQUEsQUFBSyxRQUFMLEFBQWEsQUFDakQ7QUExRWEsQUEyRWQ7O1NBQVEsZ0JBQUEsQUFBUyxHQUFFO2VBQ2xCOztNQUFJLFFBQVEsS0FBQSxBQUFLLFlBQUwsQUFBaUIsVUFBakIsQUFBMkIsU0FBUyxLQUFwQyxBQUF5QyxlQUFnQixLQUFBLEFBQUssU0FBOUQsQUFBdUUsUUFBbkYsQUFBMkYsQUFFMUY7O0dBQUMsQ0FBQyxLQUFBLEFBQUssU0FBUCxBQUFnQixXQUFXLE9BQU8sS0FBQSxBQUFLLFNBQVosQUFBcUIsWUFBakQsQUFBNkQsY0FBZSxLQUFBLEFBQUssU0FBTCxBQUFjLFFBQWQsQUFBc0IsS0FBbEcsQUFBNEUsQUFBMkIsQUFFdkc7O01BQUEsQUFBRyxHQUFFLEFBQ0o7S0FBQSxBQUFFLEFBQ0Y7S0FBQSxBQUFFLEFBQ0Y7QUFFRDs7T0FBQSxBQUFLLFlBQUwsQUFBaUIsVUFBakIsQUFBMkIsSUFBSSxLQUEvQixBQUFvQyxBQUVwQzs7U0FBQSxBQUFPLFdBQVcsWUFBTSxBQUN0QjtJQUFDLENBQUMsT0FBQSxBQUFLLFNBQVAsQUFBZ0IsU0FBUyxPQUExQixBQUErQixxQkFBc0IsT0FBckQsQUFBcUQsQUFBSyxBQUMxRDtVQUFBLEFBQUssQUFDTDtVQUFBLEFBQUssQUFDSjtJQUFDLENBQUMsT0FBQSxBQUFLLFNBQVAsQUFBZ0IsWUFBWSxPQUFPLE9BQUEsQUFBSyxTQUFaLEFBQXFCLGFBQWxELEFBQStELGNBQWUsT0FBQSxBQUFLLFNBQUwsQUFBYyxTQUFkLEFBQXVCLEtBQXJHLEFBQ0E7QUFMRCxLQUFBLEFBS0csQUFDSDtBLEFBN0ZhO0FBQUEsQUFDZDs7Ozs7Ozs7O1FDSmMsQUFDUCxBQUNQO1lBRmMsQUFFSCxBQUNYO1FBSGMsQUFHUCxBQUNQO1VBSmMsQUFJTCxBQUNUO1dBTGMsQUFLSixBQUNWO1FBTmMsQUFNUCxBQUNQO1UsQUFQYyxBQU9MO0FBUEssQUFDZCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQgVG9nZ2xlciBmcm9tICcuL2xpYnMvY29tcG9uZW50JztcblxuY29uc3Qgb25ET01Db250ZW50TG9hZGVkVGFza3MgPSBbKCkgPT4ge1xuXHRUb2dnbGVyLmluaXQoJy5qcy10b2dnbGUnKTtcblx0VG9nZ2xlci5pbml0KCcuanMtdG9nZ2xlX19sb2NhbCcsIHtcblx0XHRsb2NhbDogdHJ1ZSxcblx0XHRkZWxheTogMCxcblx0XHRjYWxsYmFjazogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZih0aGlzLm9wZW4pe1xuXHRcdFx0XHRnbG9iYWwuVG9nZ2xlcnMuZm9yRWFjaCh0b2dnbGVyID0+IHtcblx0XHRcdFx0XHRpZih0b2dnbGVyICE9PSB0aGlzICYmICEhdG9nZ2xlci5vcGVuICYmIHRvZ2dsZXIuRE9NRWxlbWVudCAhPT0gdGhpcy50YXJnZXRFbGVtZW50KXtcblx0XHRcdFx0XHRcdHRvZ2dsZXIudG9nZ2xlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufV07XG5cbmdsb2JhbC5Ub2dnbGVycyA9IHt9O1xuICAgIFxuaWYoJ2FkZEV2ZW50TGlzdGVuZXInIGluIHdpbmRvdykgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7IG9uRE9NQ29udGVudExvYWRlZFRhc2tzLmZvckVhY2goKGZuKSA9PiBmbigpKTsgfSk7IiwiaW1wb3J0IGRlZmF1bHRzIGZyb20gJy4vbGliL2RlZmF1bHRzJztcbmltcG9ydCBjb21wb25lbnRQcm90b3R5cGUgZnJvbSAnLi9saWIvY29tcG9uZW50LXByb3RvdHlwZSc7XG5cbmNvbnN0IGluaXQgPSAoc2VsLCBvcHRzKSA9PiB7XG5cdGxldCBlbHMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsKSk7XG5cdFxuXHRpZighZWxzLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCdUb2dnbGVyIGNhbm5vdCBiZSBpbml0aWFsaXNlZCwgbm8gYXVnbWVudGFibGUgZWxlbWVudHMgZm91bmQnKTtcblxuXHRyZXR1cm4gZWxzLm1hcCgoZWwpID0+IHtcblx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGNvbXBvbmVudFByb3RvdHlwZSksIHtcblx0XHRcdGJ0bjogZWwsXG5cdFx0XHR0YXJnZXRJZDogKGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpfHwgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcpKS5zdWJzdHIoMSksXG5cdFx0XHRzZXR0aW5nczogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMsIG9wdHMpXG5cdFx0fSkuaW5pdCgpO1xuXHR9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHsgaW5pdCB9OyIsImNvbnN0IFRSSUdHRVJfRVZFTlRTID0gW3dpbmRvdy5Qb2ludGVyRXZlbnQgPyAncG9pbnRlcmRvd24nIDogJ29udG91Y2hzdGFydCcgaW4gd2luZG93ID8gJ3RvdWNoc3RhcnQnIDogJ2NsaWNrJywgJ2tleWRvd24nIF0sXG4gICAgICBUUklHR0VSX0tFWUNPREVTID0gWzEzLCAzMl07XG5cbmV4cG9ydCBkZWZhdWx0IHtcblx0aW5pdCgpIHtcblx0XHR0aGlzLnRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnRhcmdldElkKTtcblx0XHR0aGlzLmNsYXNzVGFyZ2V0ID0gKCF0aGlzLnNldHRpbmdzLmxvY2FsKSA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCA6IHRoaXMudGFyZ2V0RWxlbWVudC5wYXJlbnROb2RlO1xuXHRcdHRoaXMuc2libGluZ0J0bnMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tocmVmPVwiIycgKyB0aGlzLnRhcmdldElkICsgJ1wiXSwgW2RhdGEtdGFyZ2V0PVwiIycgKyB0aGlzLnRhcmdldElkICsgJ1wiXScpKTtcblx0XHRpZih0aGlzLnNldHRpbmdzLmZvY3VzKSB0aGlzLmZvY3VzYWJsZUNoaWxkcmVuID0gdGhpcy5nZXRGb2N1c2FibGVDaGlsZHJlbigpO1xuXHRcdGlmKHRoaXMuc2V0dGluZ3MudHJhcFRhYikgdGhpcy5ib3VuZEtleUxpc3RlbmVyID0gdGhpcy5rZXlMaXN0ZW5lci5iaW5kKHRoaXMpO1xuXG5cdFx0dGhpcy5zdGF0dXNDbGFzcyA9ICF0aGlzLnNldHRpbmdzLmxvY2FsID8gYG9uLS0ke3RoaXMudGFyZ2V0SWR9YCA6ICdhY3RpdmUnO1xuXHRcdHRoaXMuYW5pbWF0aW5nQ2xhc3MgPSAhdGhpcy5zZXR0aW5ncy5sb2NhbCA/IGBhbmltYXRpbmctLSR7dGhpcy50YXJnZXRJZH1gIDogJ2FuaW1hdGluZyc7XG5cblx0XHR0aGlzLnNpYmxpbmdCdG5zLmZvckVhY2goYnRuID0+IHtcblx0XHRcdGJ0bi5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCdidXR0b24nKTtcblx0XHRcdGJ0bi5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCB0aGlzLnRhcmdldElkKTtcblx0XHRcdGJ0bi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcblx0XHR9KTtcblxuICAgICAgICBUUklHR0VSX0VWRU5UUy5mb3JFYWNoKGV2ID0+IHtcblx0XHQgICAgdGhpcy5idG4uYWRkRXZlbnRMaXN0ZW5lcihldiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYoISFlLmtleUNvZGUgJiYgIX5UUklHR0VSX0tFWUNPREVTLmluZGV4T2YoZS5rZXlDb2RlKSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXHRcdHRoaXMuc2V0dGluZ3Muc3RhcnRPcGVuICYmIHRoaXMudG9nZ2xlKCk7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cdGdldEZvY3VzYWJsZUNoaWxkcmVuKCkge1xuXHRcdGNvbnN0IGZvY3VzYWJsZUVsZW1lbnRzID0gWydhW2hyZWZdJywgJ2FyZWFbaHJlZl0nLCAnaW5wdXQ6bm90KFtkaXNhYmxlZF0pJywgJ3NlbGVjdDpub3QoW2Rpc2FibGVkXSknLCAndGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pJywgJ2J1dHRvbjpub3QoW2Rpc2FibGVkXSknLCAnaWZyYW1lJywgJ29iamVjdCcsICdlbWJlZCcsICdbY29udGVudGVkaXRhYmxlXScsICdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9XCItMVwiXSknXTtcblxuXHRcdHJldHVybiBbXS5zbGljZS5jYWxsKHRoaXMudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvY3VzYWJsZUVsZW1lbnRzLmpvaW4oJywnKSkpO1xuXHR9LFxuXHR0b2dnbGVBdHRyaWJ1dGVzOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuaXNPcGVuID0gIXRoaXMuaXNPcGVuO1xuXHRcdHRoaXMuc2libGluZ0J0bnMuZm9yRWFjaChzaWJsaW5nID0+IHtcblx0XHRcdHNpYmxpbmcuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgc2libGluZy5nZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKSA9PT0gJ3RydWUnID8gJ2ZhbHNlJyA6ICd0cnVlJyk7XG5cdFx0fSk7XG5cdH0sXG5cdHRvZ2dsZURvY3VtZW50U3RhdGU6IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5jbGFzc1RhcmdldC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuYW5pbWF0aW5nQ2xhc3MpO1xuXHRcdHRoaXMuY2xhc3NUYXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLnN0YXR1c0NsYXNzKTtcblx0fSxcblx0bWFuYWdlRm9jdXM6IGZ1bmN0aW9uKCl7XG5cdFx0aWYoIXRoaXMuaXNPcGVuKXtcblx0XHRcdHRoaXMubGFzdEZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHRcdFx0dGhpcy5mb2N1c2FibGVDaGlsZHJlbi5sZW5ndGggJiYgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5mb2N1c2FibGVDaGlsZHJlblswXS5mb2N1cygpLCB0aGlzLnNldHRpbmdzLmRlbGF5KTtcblx0XHRcdHRoaXMuc2V0dGluZ3MudHJhcFRhYiAmJiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5ib3VuZEtleUxpc3RlbmVyKTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnRyYXBUYWIgJiYgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuYm91bmRLZXlMaXN0ZW5lcik7XG5cdFx0XHR0aGlzLmZvY3VzYWJsZUNoaWxkcmVuLmxlbmd0aCAmJiB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMubGFzdEZvY3VzZWQuZm9jdXMoKTtcblx0XHRcdFx0dGhpcy5sYXN0Rm9jdXNlZCA9IGZhbHNlO1xuXHRcdFx0fSwgdGhpcy5zZXR0aW5ncy5kZWxheSk7XG5cdFx0fVxuXHR9LFxuXHR0cmFwVGFiOiBmdW5jdGlvbihlKXtcblx0XHRsZXQgZm9jdXNlZEluZGV4ID0gdGhpcy5mb2N1c2FibGVDaGlsZHJlbi5pbmRleE9mKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpO1xuXHRcdGlmKGUuc2hpZnRLZXkgJiYgZm9jdXNlZEluZGV4ID09PSAwKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLmZvY3VzYWJsZUNoaWxkcmVuW3RoaXMuZm9jdXNhYmxlQ2hpbGRyZW4ubGVuZ3RoIC0gMV0uZm9jdXMoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYoIWUuc2hpZnRLZXkgJiYgZm9jdXNlZEluZGV4ID09PSB0aGlzLmZvY3VzYWJsZUNoaWxkcmVuLmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLmZvY3VzYWJsZUNoaWxkcmVuWzBdLmZvY3VzKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXHRrZXlMaXN0ZW5lcihlKXtcblx0XHRpZiAodGhpcy5pc09wZW4gJiYgZS5rZXlDb2RlID09PSAyNykge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy50b2dnbGUoKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuaXNPcGVuICYmIGUua2V5Q29kZSA9PT0gOSkgdGhpcy50cmFwVGFiKGUpO1xuXHR9LFxuXHR0b2dnbGU6IGZ1bmN0aW9uKGUpe1xuXHRcdGxldCBkZWxheSA9IHRoaXMuY2xhc3NUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuc3RhdHVzQ2xhc3MpID8gIHRoaXMuc2V0dGluZ3MuZGVsYXkgOiAwO1xuXG5cdFx0KCEhdGhpcy5zZXR0aW5ncy5wcmVob29rICYmIHR5cGVvZiB0aGlzLnNldHRpbmdzLnByZWhvb2sgPT09ICdmdW5jdGlvbicpICYmIHRoaXMuc2V0dGluZ3MucHJlaG9vay5jYWxsKHRoaXMpO1xuXHRcdFxuXHRcdGlmKGUpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5jbGFzc1RhcmdldC5jbGFzc0xpc3QuYWRkKHRoaXMuYW5pbWF0aW5nQ2xhc3MpO1xuXHRcdFxuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdCghIXRoaXMuc2V0dGluZ3MuZm9jdXMgJiYgdGhpcy5mb2N1c2FibGVDaGlsZHJlbikgJiYgdGhpcy5tYW5hZ2VGb2N1cygpO1xuXHRcdFx0dGhpcy50b2dnbGVBdHRyaWJ1dGVzKCk7XG5cdFx0XHR0aGlzLnRvZ2dsZURvY3VtZW50U3RhdGUoKTtcblx0XHRcdCghIXRoaXMuc2V0dGluZ3MuY2FsbGJhY2sgJiYgdHlwZW9mIHRoaXMuc2V0dGluZ3MuY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpICYmIHRoaXMuc2V0dGluZ3MuY2FsbGJhY2suY2FsbCh0aGlzKTtcblx0XHR9LCBkZWxheSk7XG5cdH1cbn0iLCJleHBvcnQgZGVmYXVsdCB7XG5cdGRlbGF5OiAwLFxuXHRzdGFydE9wZW46IGZhbHNlLFxuXHRsb2NhbDogZmFsc2UsXG5cdHByZWhvb2s6IGZhbHNlLFxuXHRjYWxsYmFjazogZmFsc2UsXG5cdGZvY3VzOiB0cnVlLFxuXHR0cmFwVGFiOiBmYWxzZVxufTsiXX0=
