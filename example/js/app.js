(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
'use strict';

var _component = require('./libs/component');

var _component2 = _interopRequireDefault(_component);

function _interopRequireDefault(obj) {
	return obj && obj.__esModule ? obj : { default: obj };
}

var onDOMContentLoadedTasks = [function () {
	_component2.default.init('.js-toggle');
	_component2.default.init('.js-toggle__local', {
		local: true,
		delay: 0,
		callback: function callback() {
			var _this = this;

			if (this.open) {
				global.Togglers.forEach(function (toggler) {
					if (toggler !== _this && !!toggler.open && toggler.DOMElement !== _this.targetElement) {
						toggler.toggle();
					}
				});
			}
		}
	});
}];

global.Togglers = {};

if ('addEventListener' in window) window.addEventListener('DOMContentLoaded', function () {
	onDOMContentLoadedTasks.forEach(function (fn) {
		return fn();
	});
});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./libs/component":2}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _defaults = require('./libs/defaults');

var _defaults2 = _interopRequireDefault(_defaults);

var _componentPrototype = require('./libs/component-prototype');

var _componentPrototype2 = _interopRequireDefault(_componentPrototype);

function _interopRequireDefault(obj) {
	return obj && obj.__esModule ? obj : { default: obj };
}

var init = function init(sel, opts) {
	var els = [].slice.call(document.querySelectorAll(sel));

	if (!els.length) throw new Error('Toggler cannot be initialised, no augmentable elements found');

	return els.map(function (el) {
		return Object.assign(Object.create(_componentPrototype2.default), {
			btn: el,
			targetId: (el.getAttribute('href') || el.getAttribute('data-target')).substr(1),
			settings: Object.assign({}, _defaults2.default, opts)
		}).init();
	});
};

exports.default = { init: init };

},{"./libs/component-prototype":3,"./libs/defaults":4}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
var TRIGGER_EVENTS = [window.PointerEvent ? 'pointerdown' : 'ontouchstart' in window ? 'touchstart' : 'click', 'keydown'],
    TRIGGER_KEYCODES = [13, 32];

exports.default = {
	init: function init() {
		var _this = this;

		this.targetElement = document.getElementById(this.targetId);
		this.classTarget = !this.settings.local ? document.documentElement : this.targetElement.parentNode;
		this.siblingBtns = [].slice.call(document.querySelectorAll('[href="#' + this.targetId + '"], [data-target="#' + this.targetId + '"]'));
		if (this.settings.focus) this.focusableChildren = this.getFocusableChildren();
		if (this.settings.trapTab) this.boundKeyListener = this.keyListener.bind(this);

		this.statusClass = !this.settings.local ? 'on--' + this.targetId : 'active';
		this.animatingClass = !this.settings.local ? 'animating--' + this.targetId : 'animating';

		this.siblingBtns.forEach(function (btn) {
			btn.setAttribute('role', 'button');
			btn.setAttribute('aria-controls', _this.targetId);
			btn.setAttribute('aria-expanded', 'false');
		});

		TRIGGER_EVENTS.forEach(function (ev) {
			_this.btn.addEventListener(ev, function (e) {
				if (!!e.keyCode && !~TRIGGER_KEYCODES.indexOf(e.keyCode)) return;
				_this.toggle(e);
			});
		});
		this.settings.startOpen && this.toggle();

		return this;
	},
	getFocusableChildren: function getFocusableChildren() {
		var focusableElements = ['a[href]', 'area[href]', 'input:not([disabled])', 'select:not([disabled])', 'textarea:not([disabled])', 'button:not([disabled])', 'iframe', 'object', 'embed', '[contenteditable]', '[tabindex]:not([tabindex="-1"])'];

		return [].slice.call(this.targetElement.querySelectorAll(focusableElements.join(',')));
	},

	toggleAttributes: function toggleAttributes() {
		this.isOpen = !this.isOpen;
		this.siblingBtns.forEach(function (sibling) {
			sibling.setAttribute('aria-expanded', sibling.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
		});
	},
	toggleDocumentState: function toggleDocumentState() {
		this.classTarget.classList.remove(this.animatingClass);
		this.classTarget.classList.toggle(this.statusClass);
	},
	manageFocus: function manageFocus() {
		var _this2 = this;

		if (!this.isOpen) {
			this.lastFocused = document.activeElement;
			this.focusableChildren.length && window.setTimeout(function () {
				return _this2.focusableChildren[0].focus();
			}, this.settings.delay);
			this.settings.trapTab && document.addEventListener('keydown', this.boundKeyListener);
		} else {
			this.settings.trapTab && document.removeEventListener('keydown', this.boundKeyListener);
			this.focusableChildren.length && window.setTimeout(function () {
				_this2.lastFocused.focus();
				_this2.lastFocused = false;
			}, this.settings.delay);
		}
	},
	trapTab: function trapTab(e) {
		var focusedIndex = this.focusableChildren.indexOf(document.activeElement);
		if (e.shiftKey && focusedIndex === 0) {
			e.preventDefault();
			this.focusableChildren[this.focusableChildren.length - 1].focus();
		} else {
			if (!e.shiftKey && focusedIndex === this.focusableChildren.length - 1) {
				e.preventDefault();
				this.focusableChildren[0].focus();
			}
		}
	},
	keyListener: function keyListener(e) {
		if (this.isOpen && e.keyCode === 27) {
			e.preventDefault();
			this.toggle();
		}
		if (this.isOpen && e.keyCode === 9) this.trapTab(e);
	},

	toggle: function toggle(e) {
		var _this3 = this;

		var delay = this.classTarget.classList.contains(this.statusClass) ? this.settings.delay : 0;

		!!this.settings.prehook && typeof this.settings.prehook === 'function' && this.settings.prehook.call(this);

		if (e) {
			e.preventDefault();
			e.stopPropagation();
		}

		this.classTarget.classList.add(this.animatingClass);

		window.setTimeout(function () {
			!!_this3.settings.focus && _this3.focusableChildren && _this3.manageFocus();
			_this3.toggleAttributes();
			_this3.toggleDocumentState();
			!!_this3.settings.callback && typeof _this3.settings.callback === 'function' && _this3.settings.callback.call(_this3);
		}, delay);
	}
};

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = {
	delay: 0,
	startOpen: false,
	local: false,
	prehook: false,
	callback: false,
	focus: true,
	trapTab: false
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJleGFtcGxlL3NyYy9hcHAuanMiLCJleGFtcGxlL3NyYy9saWJzL2NvbXBvbmVudC9pbmRleC5qcyIsImV4YW1wbGUvc3JjL2xpYnMvY29tcG9uZW50L2xpYnMvY29tcG9uZW50LXByb3RvdHlwZS5qcyIsImV4YW1wbGUvc3JjL2xpYnMvY29tcG9uZW50L2xpYnMvZGVmYXVsdHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUNBQTs7Ozs7Ozs7QUFFQSxJQUFNLDJCQUEyQixZQUFNLEFBQ3RDO3FCQUFBLEFBQVEsS0FBUixBQUFhLEFBQ2I7cUJBQUEsQUFBUSxLQUFSLEFBQWE7U0FBcUIsQUFDMUIsQUFDUDtTQUZpQyxBQUUxQixBQUNQO1lBQVUsb0JBQVc7ZUFDcEI7O09BQUcsS0FBSCxBQUFRLE1BQUssQUFDWjtXQUFBLEFBQU8sU0FBUCxBQUFnQixRQUFRLG1CQUFXLEFBQ2xDO1NBQUcscUJBQW9CLENBQUMsQ0FBQyxRQUF0QixBQUE4QixRQUFRLFFBQUEsQUFBUSxlQUFlLE1BQWhFLEFBQXFFLGVBQWMsQUFDbEY7Y0FBQSxBQUFRLEFBQ1I7QUFDRDtBQUpELEFBS0E7QUFDRDtBQVhGLEFBQWtDLEFBYWxDO0FBYmtDLEFBQ2pDO0FBSEYsQUFBZ0MsQ0FBQTs7QUFpQmhDLE9BQUEsQUFBTyxXQUFQLEFBQWtCOztBQUVsQixJQUFHLHNCQUFILEFBQXlCLGVBQVEsQUFBTyxpQkFBUCxBQUF3QixvQkFBb0IsWUFBTSxBQUFFO3lCQUFBLEFBQXdCLFFBQVEsVUFBQSxBQUFDLElBQUQ7U0FBQSxBQUFRO0FBQXhDLEFBQWdEO0FBQXBHLENBQUE7Ozs7Ozs7Ozs7O0FDckJqQzs7OztBQUNBOzs7Ozs7OztBQUVBLElBQU0sT0FBTyxTQUFQLEFBQU8sS0FBQSxBQUFDLEtBQUQsQUFBTSxNQUFTLEFBQzNCO0tBQUksTUFBTSxHQUFBLEFBQUcsTUFBSCxBQUFTLEtBQUssU0FB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QVcsT0FBTyxLQUFBLEFBQUssU0FBWixBQUFxQixZQUFqRCxBQUE2RCxjQUFlLEtBQUEsQUFBSyxTQUFMLEFBQWMsUUFBZCxBQUFzQixLQUFsRyxBQUE0RSxBQUEyQixBQUV2Rzs7TUFBQSxBQUFHLEdBQUUsQUFDSjtLQUFBLEFBQUUsQUFDRjtLQUFBLEFBQUUsQUFDRjtBQUVEOztPQUFBLEFBQUssWUFBTCxBQUFpQixVQUFqQixBQUEyQixJQUFJLEtBQS9CLEFBQW9DLEFBRXBDOztTQUFBLEFBQU8sV0FBVyxZQUFNLEFBQ3RCO0lBQUMsQ0FBQyxPQUFBLEFBQUssU0FBUCxBQUFnQixTQUFTLE9BQTFCLEFBQStCLHFCQUFzQixPQUFyRCxBQUFxRCxBQUFLLEFBQzFEO1VBQUEsQUFBSyxBQUNMO1VBQUEsQUFBSyxBQUNKO0lBQUMsQ0FBQyxPQUFBLEFBQUssU0FBUCxBQUFnQixZQUFZLE9BQU8sT0FBQSxBQUFLLFNBQVosQUFBcUIsYUFBbEQsQUFBK0QsY0FBZSxPQUFBLEFBQUssU0FBTCxBQUFjLFNBQWQsQUFBdUIsS0FBckcsQUFDQTtBQUxELEtBQUEsQUFLRyxBQUNIO0EsQUE3RmE7QUFBQSxBQUNkOzs7Ozs7Ozs7UUNKYyxBQUNQLEFBQ1A7WUFGYyxBQUVILEFBQ1g7UUFIYyxBQUdQLEFBQ1A7VUFKYyxBQUlMLEFBQ1Q7V0FMYyxBQUtKLEFBQ1Y7UUFOYyxBQU1QLEFBQ1A7VSxBQVBjLEFBT0w7QUFQSyxBQUNkIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBUb2dnbGVyIGZyb20gJy4vbGlicy9jb21wb25lbnQnO1xuXG5jb25zdCBvbkRPTUNvbnRlbnRMb2FkZWRUYXNrcyA9IFsoKSA9PiB7XG5cdFRvZ2dsZXIuaW5pdCgnLmpzLXRvZ2dsZScpO1xuXHRUb2dnbGVyLmluaXQoJy5qcy10b2dnbGVfX2xvY2FsJywge1xuXHRcdGxvY2FsOiB0cnVlLFxuXHRcdGRlbGF5OiAwLFxuXHRcdGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcblx0XHRcdGlmKHRoaXMub3Blbil7XG5cdFx0XHRcdGdsb2JhbC5Ub2dnbGVycy5mb3JFYWNoKHRvZ2dsZXIgPT4ge1xuXHRcdFx0XHRcdGlmKHRvZ2dsZXIgIT09IHRoaXMgJiYgISF0b2dnbGVyLm9wZW4gJiYgdG9nZ2xlci5ET01FbGVtZW50ICE9PSB0aGlzLnRhcmdldEVsZW1lbnQpe1xuXHRcdFx0XHRcdFx0dG9nZ2xlci50b2dnbGUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XTtcblxuZ2xvYmFsLlRvZ2dsZXJzID0ge307XG4gICAgXG5pZignYWRkRXZlbnRMaXN0ZW5lcicgaW4gd2luZG93KSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsgb25ET01Db250ZW50TG9hZGVkVGFza3MuZm9yRWFjaCgoZm4pID0+IGZuKCkpOyB9KTsiLCJpbXBvcnQgZGVmYXVsdHMgZnJvbSAnLi9saWJzL2RlZmF1bHRzJztcbmltcG9ydCBjb21wb25lbnRQcm90b3R5cGUgZnJvbSAnLi9saWJzL2NvbXBvbmVudC1wcm90b3R5cGUnO1xuXG5jb25zdCBpbml0ID0gKHNlbCwgb3B0cykgPT4ge1xuXHRsZXQgZWxzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbCkpO1xuXHRcblx0aWYoIWVscy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignVG9nZ2xlciBjYW5ub3QgYmUgaW5pdGlhbGlzZWQsIG5vIGF1Z21lbnRhYmxlIGVsZW1lbnRzIGZvdW5kJyk7XG5cblx0cmV0dXJuIGVscy5tYXAoKGVsKSA9PiB7XG5cdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShjb21wb25lbnRQcm90b3R5cGUpLCB7XG5cdFx0XHRidG46IGVsLFxuXHRcdFx0dGFyZ2V0SWQ6IChlbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKXx8IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKSkuc3Vic3RyKDEpLFxuXHRcdFx0c2V0dGluZ3M6IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRzLCBvcHRzKVxuXHRcdH0pLmluaXQoKTtcblx0fSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB7IGluaXQgfTsiLCJjb25zdCBUUklHR0VSX0VWRU5UUyA9IFt3aW5kb3cuUG9pbnRlckV2ZW50ID8gJ3BvaW50ZXJkb3duJyA6ICdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdyA/ICd0b3VjaHN0YXJ0JyA6ICdjbGljaycsICdrZXlkb3duJyBdLFxuICAgICAgVFJJR0dFUl9LRVlDT0RFUyA9IFsxMywgMzJdO1xuXG5leHBvcnQgZGVmYXVsdCB7XG5cdGluaXQoKSB7XG5cdFx0dGhpcy50YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy50YXJnZXRJZCk7XG5cdFx0dGhpcy5jbGFzc1RhcmdldCA9ICghdGhpcy5zZXR0aW5ncy5sb2NhbCkgPyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgOiB0aGlzLnRhcmdldEVsZW1lbnQucGFyZW50Tm9kZTtcblx0XHR0aGlzLnNpYmxpbmdCdG5zID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbaHJlZj1cIiMnICsgdGhpcy50YXJnZXRJZCArICdcIl0sIFtkYXRhLXRhcmdldD1cIiMnICsgdGhpcy50YXJnZXRJZCArICdcIl0nKSk7XG5cdFx0aWYodGhpcy5zZXR0aW5ncy5mb2N1cykgdGhpcy5mb2N1c2FibGVDaGlsZHJlbiA9IHRoaXMuZ2V0Rm9jdXNhYmxlQ2hpbGRyZW4oKTtcblx0XHRpZih0aGlzLnNldHRpbmdzLnRyYXBUYWIpIHRoaXMuYm91bmRLZXlMaXN0ZW5lciA9IHRoaXMua2V5TGlzdGVuZXIuYmluZCh0aGlzKTtcblxuXHRcdHRoaXMuc3RhdHVzQ2xhc3MgPSAhdGhpcy5zZXR0aW5ncy5sb2NhbCA/IGBvbi0tJHt0aGlzLnRhcmdldElkfWAgOiAnYWN0aXZlJztcblx0XHR0aGlzLmFuaW1hdGluZ0NsYXNzID0gIXRoaXMuc2V0dGluZ3MubG9jYWwgPyBgYW5pbWF0aW5nLS0ke3RoaXMudGFyZ2V0SWR9YCA6ICdhbmltYXRpbmcnO1xuXG5cdFx0dGhpcy5zaWJsaW5nQnRucy5mb3JFYWNoKGJ0biA9PiB7XG5cdFx0XHRidG4uc2V0QXR0cmlidXRlKCdyb2xlJywnYnV0dG9uJyk7XG5cdFx0XHRidG4uc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGhpcy50YXJnZXRJZCk7XG5cdFx0XHRidG4uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0fSk7XG5cbiAgICAgICAgVFJJR0dFUl9FVkVOVFMuZm9yRWFjaChldiA9PiB7XG5cdFx0ICAgIHRoaXMuYnRuLmFkZEV2ZW50TGlzdGVuZXIoZXYsIGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmKCEhZS5rZXlDb2RlICYmICF+VFJJR0dFUl9LRVlDT0RFUy5pbmRleE9mKGUua2V5Q29kZSkpIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZShlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblx0XHR0aGlzLnNldHRpbmdzLnN0YXJ0T3BlbiAmJiB0aGlzLnRvZ2dsZSgpO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXHRnZXRGb2N1c2FibGVDaGlsZHJlbigpIHtcblx0XHRjb25zdCBmb2N1c2FibGVFbGVtZW50cyA9IFsnYVtocmVmXScsICdhcmVhW2hyZWZdJywgJ2lucHV0Om5vdChbZGlzYWJsZWRdKScsICdzZWxlY3Q6bm90KFtkaXNhYmxlZF0pJywgJ3RleHRhcmVhOm5vdChbZGlzYWJsZWRdKScsICdidXR0b246bm90KFtkaXNhYmxlZF0pJywgJ2lmcmFtZScsICdvYmplY3QnLCAnZW1iZWQnLCAnW2NvbnRlbnRlZGl0YWJsZV0nLCAnW3RhYmluZGV4XTpub3QoW3RhYmluZGV4PVwiLTFcIl0pJ107XG5cblx0XHRyZXR1cm4gW10uc2xpY2UuY2FsbCh0aGlzLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChmb2N1c2FibGVFbGVtZW50cy5qb2luKCcsJykpKTtcblx0fSxcblx0dG9nZ2xlQXR0cmlidXRlczogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmlzT3BlbiA9ICF0aGlzLmlzT3Blbjtcblx0XHR0aGlzLnNpYmxpbmdCdG5zLmZvckVhY2goc2libGluZyA9PiB7XG5cdFx0XHRzaWJsaW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIHNpYmxpbmcuZ2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJykgPT09ICd0cnVlJyA/ICdmYWxzZScgOiAndHJ1ZScpO1xuXHRcdH0pO1xuXHR9LFxuXHR0b2dnbGVEb2N1bWVudFN0YXRlOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuY2xhc3NUYXJnZXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmFuaW1hdGluZ0NsYXNzKTtcblx0XHR0aGlzLmNsYXNzVGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUodGhpcy5zdGF0dXNDbGFzcyk7XG5cdH0sXG5cdG1hbmFnZUZvY3VzOiBmdW5jdGlvbigpe1xuXHRcdGlmKCF0aGlzLmlzT3Blbil7XG5cdFx0XHR0aGlzLmxhc3RGb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblx0XHRcdHRoaXMuZm9jdXNhYmxlQ2hpbGRyZW4ubGVuZ3RoICYmIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMuZm9jdXNhYmxlQ2hpbGRyZW5bMF0uZm9jdXMoKSwgdGhpcy5zZXR0aW5ncy5kZWxheSk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnRyYXBUYWIgJiYgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuYm91bmRLZXlMaXN0ZW5lcik7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dGhpcy5zZXR0aW5ncy50cmFwVGFiICYmIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmJvdW5kS2V5TGlzdGVuZXIpO1xuXHRcdFx0dGhpcy5mb2N1c2FibGVDaGlsZHJlbi5sZW5ndGggJiYgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmxhc3RGb2N1c2VkLmZvY3VzKCk7XG5cdFx0XHRcdHRoaXMubGFzdEZvY3VzZWQgPSBmYWxzZTtcblx0XHRcdH0sIHRoaXMuc2V0dGluZ3MuZGVsYXkpO1xuXHRcdH1cblx0fSxcblx0dHJhcFRhYjogZnVuY3Rpb24oZSl7XG5cdFx0bGV0IGZvY3VzZWRJbmRleCA9IHRoaXMuZm9jdXNhYmxlQ2hpbGRyZW4uaW5kZXhPZihkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcblx0XHRpZihlLnNoaWZ0S2V5ICYmIGZvY3VzZWRJbmRleCA9PT0gMCkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5mb2N1c2FibGVDaGlsZHJlblt0aGlzLmZvY3VzYWJsZUNoaWxkcmVuLmxlbmd0aCAtIDFdLmZvY3VzKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmKCFlLnNoaWZ0S2V5ICYmIGZvY3VzZWRJbmRleCA9PT0gdGhpcy5mb2N1c2FibGVDaGlsZHJlbi5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5mb2N1c2FibGVDaGlsZHJlblswXS5mb2N1cygpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0a2V5TGlzdGVuZXIoZSl7XG5cdFx0aWYgKHRoaXMuaXNPcGVuICYmIGUua2V5Q29kZSA9PT0gMjcpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMudG9nZ2xlKCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmlzT3BlbiAmJiBlLmtleUNvZGUgPT09IDkpIHRoaXMudHJhcFRhYihlKTtcblx0fSxcblx0dG9nZ2xlOiBmdW5jdGlvbihlKXtcblx0XHRsZXQgZGVsYXkgPSB0aGlzLmNsYXNzVGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLnN0YXR1c0NsYXNzKSA/ICB0aGlzLnNldHRpbmdzLmRlbGF5IDogMDtcblxuXHRcdCghIXRoaXMuc2V0dGluZ3MucHJlaG9vayAmJiB0eXBlb2YgdGhpcy5zZXR0aW5ncy5wcmVob29rID09PSAnZnVuY3Rpb24nKSAmJiB0aGlzLnNldHRpbmdzLnByZWhvb2suY2FsbCh0aGlzKTtcblx0XHRcblx0XHRpZihlKXtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuY2xhc3NUYXJnZXQuY2xhc3NMaXN0LmFkZCh0aGlzLmFuaW1hdGluZ0NsYXNzKTtcblx0XHRcblx0XHR3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHQoISF0aGlzLnNldHRpbmdzLmZvY3VzICYmIHRoaXMuZm9jdXNhYmxlQ2hpbGRyZW4pICYmIHRoaXMubWFuYWdlRm9jdXMoKTtcblx0XHRcdHRoaXMudG9nZ2xlQXR0cmlidXRlcygpO1xuXHRcdFx0dGhpcy50b2dnbGVEb2N1bWVudFN0YXRlKCk7XG5cdFx0XHQoISF0aGlzLnNldHRpbmdzLmNhbGxiYWNrICYmIHR5cGVvZiB0aGlzLnNldHRpbmdzLmNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSAmJiB0aGlzLnNldHRpbmdzLmNhbGxiYWNrLmNhbGwodGhpcyk7XG5cdFx0fSwgZGVsYXkpO1xuXHR9XG59IiwiZXhwb3J0IGRlZmF1bHQge1xuXHRkZWxheTogMCxcblx0c3RhcnRPcGVuOiBmYWxzZSxcblx0bG9jYWw6IGZhbHNlLFxuXHRwcmVob29rOiBmYWxzZSxcblx0Y2FsbGJhY2s6IGZhbHNlLFxuXHRmb2N1czogdHJ1ZSxcblx0dHJhcFRhYjogZmFsc2Vcbn07Il19
